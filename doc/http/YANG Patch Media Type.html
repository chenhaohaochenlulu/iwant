<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>YANG Patch Media Type</title><script type="application/javascript">
function anchorRewrite() {
  map = { };
  if (window.location.hash.length >= 1) {
    var fragid = window.location.hash.substr(1);
    if (fragid) {
      if (! document.getElementById(fragid)) {
        var prefix = "rfc.";
        var mapped = map[fragid];
        if (mapped) {
          window.location.hash = mapped;
        } else if (fragid.indexOf("section-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(8);
        } else if (fragid.indexOf("appendix-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(9);
        } else if (fragid.indexOf("s-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(2);
        } else if (fragid.indexOf("p-") == 0) {
          var r = fragid.substring(2);
          var p = r.indexOf("-");
          if (p >= 0) {
            window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
          }
        }
      }
    }  
  }
}
window.addEventListener('hashchange', anchorRewrite);
window.addEventListener('DOMContentLoaded', anchorRewrite);
</script><style type="text/css" title="Xml2Rfc (sans serif)">
a {
  text-decoration: none;
}
a.smpl {
  color: black;
}
a:hover {
  text-decoration: underline;
}
a:active {
  text-decoration: underline;
}
address {
  margin-top: 1em;
  margin-left: 2em;
  font-style: normal;
}
body {
  color: black;
  font-family: cambria, georgia, serif;
  font-size: 12pt;
  margin: 2em auto;
  max-width: 1000px;
}
samp, span.tt, code, pre {
  font-family: consolas, monaco, monospace;
}
cite {
  font-style: normal;
}
dl {
  margin-left: 2em;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: .0em;
}
dl > dd > dl {
  margin-top: 0.5em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}
dl p {
  margin-left: 0em;
}
dl.reference > dt {
  font-weight: bold;
}
dl.reference > dd {
  margin-left: 6em;
}
h1 {
  color: green;
  font-size: 150%;
  line-height: 18pt;
  font-weight: bold;
  text-align: center;
  margin-top: 36pt;
  margin-bottom: 0pt;
}
h2 {
  font-size: 130%;
  line-height: 21pt;
  page-break-after: avoid;
}
h2.np {
  page-break-before: always;
}
h3 {
  font-size: 120%;
  line-height: 15pt;
  page-break-after: avoid;
}
h4 {
  font-size: 110%;
  page-break-after: avoid;
}
h5, h6 {
  page-break-after: avoid;
}
h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
  color: black;
}
img {
  margin-left: 3em;
}
li {
  margin-left: 2em;
}
ol {
  margin-left: 2em;
}
ol.la {
  list-style-type: lower-alpha;
}
ol.ua {
  list-style-type: upper-alpha;
}
ol p {
  margin-left: 0em;
}
p {
  margin-left: 2em;
}
pre {
  font-size: 11pt;
  margin-left: 3em;
  background-color: lightyellow;
  padding: .25em;
  page-break-inside: avoid;
}
pre.text2 {
  border-style: dotted;
  border-width: 1px;
  background-color: #f0f0f0;
}
pre.inline {
  background-color: white;
  padding: 0em;
  page-break-inside: auto;
}
pre.text {
  border-style: dotted;
  border-width: 1px;
  background-color: #f8f8f8;
}
pre.drawing {
  border-style: solid;
  border-width: 1px;
  background-color: #f8f8f8;
  padding: 2em;
}
table {
  margin-left: 2em;
}
table.tt {
  border-collapse: collapse;
  border-color: gray;
  border-spacing: 0; 
  vertical-align: top;
 }
table.tt th {
  border-color: gray;
  padding: 3px;
}
table.tt td {
  border-color: gray;
  padding: 3px;
}
table.all {
  border-style: solid;
  border-width: 2px;
}
table.full {
  border-style: solid;
  border-width: 2px;
}
table.tt td {
  vertical-align: top;
}
table.all td {
  border-style: solid;
  border-width: 1px;
}
table.full td {
  border-style: none solid;
  border-width: 1px;
}
table.tt th {
  vertical-align: top;
}
table.all th {
  border-style: solid;
  border-width: 1px;
}
table.full th {
  border-style: solid;
  border-width: 1px 1px 2px 1px;
}
table.headers th {
  border-style: none none solid none;
  border-width: 2px;
}
table.tleft {
  margin-right: auto;
}
table.tright {
  margin-left: auto;
}
table.tcenter {
  margin-left: auto;
  margin-right: auto;
}
caption {
  caption-side: bottom;
  font-weight: bold;
  font-size: 10pt;
  margin-top: .5em;
}

table.header {
  border-spacing: 1px;
  width: 95%;
  font-size: 11pt;
  color: white;
}
td.top {
  vertical-align: top;
}
td.topnowrap {
  vertical-align: top;
  white-space: nowrap;
}
table.header td {
  background-color: gray;
  width: 50%;
}
ul.toc, ul.toc ul {
  list-style: none;
  margin-left: 1.5em;
  padding-left: 0em;
}
ul.toc li {
  line-height: 150%;
  font-weight: bold;
  margin-left: 0em;
}
ul.toc li li {
  line-height: normal;
  font-weight: normal;
  font-size: 11pt;
  margin-left: 0em;
}
li.excluded {
  font-size: 0pt;
}
ul p {
  margin-left: 0em;
}
.filename, h1, h2, h3, h4 {
  font-family: candara, calibri, segoe, optima, arial, sans-serif;
}

.comment {
  background-color: yellow;
}
.center {
  text-align: center;
}
.error {
  color: red;
  font-style: italic;
  font-weight: bold;
}
.figure {
  font-weight: bold;
  text-align: center;
  font-size: 10pt;
}
.filename {
  color: #333333;
  font-size: 112%;
  font-weight: bold;
  line-height: 21pt;
  text-align: center;
  margin-top: 0pt;
}
.fn {
  font-weight: bold;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.warning {
  font-size: 130%;
  background-color: yellow;
}

@media screen {
  pre.text, pre.text2 {
    width: 69em;
  }
}

@media print {
  .noprint {
    display: none;
  }

  a {
    color: black;
    text-decoration: none;
  }

  table.header {
    width: 90%;
  }

  td.header {
    width: 50%;
    color: black;
    background-color: white;
    vertical-align: top;
    font-size: 110%;
  }

  ul.toc a:last-child::after {
    content: leader('.') target-counter(attr(href), page);
  }

  ul.ind li li a {
    content: target-counter(attr(href), page);
  }

  pre {
    font-size: 10pt;
  }

  .print2col {
    column-count: 2;
    -moz-column-count: 2;
    column-fill: auto;
  }
}
@page {
  @top-left {
       content: "Internet-Draft";
  }
  @top-right {
       content: "November 2016";
  }
  @top-center {
       content: "YANG Patch";
  }
  @bottom-left {
       content: "Bierman, et al.";
  }
  @bottom-center {
       content: "Expires May 17, 2017";
  }
  @bottom-right {
       content: "[Page " counter(page) "]";
  }
}
@page:first {
    @top-left {
      content: normal;
    }
    @top-right {
      content: normal;
    }
    @top-center {
      content: normal;
    }
}
</style><link rel="Contents" href="#rfc.toc"><link rel="Author" href="#rfc.authors"><link rel="Copyright" href="#rfc.copyrightnotice"><link rel="Chapter" title="1 Introduction" href="#rfc.section.1"><link rel="Chapter" title="2 YANG Patch" href="#rfc.section.2"><link rel="Chapter" title="3 YANG Module" href="#rfc.section.3"><link rel="Chapter" title="4 IANA Considerations" href="#rfc.section.4"><link rel="Chapter" title="5 Security Considerations" href="#rfc.section.5"><link rel="Chapter" href="#rfc.section.6" title="6 Normative References"><link rel="Appendix" title="A Acknowledgements" href="#rfc.section.A"><link rel="Appendix" title="B Change Log" href="#rfc.section.B"><link rel="Appendix" title="C Open Issues" href="#rfc.section.C"><link rel="Appendix" title="D Example YANG Module" href="#rfc.section.D"><meta name="generator" content="http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.839, 2016/07/27 09:00:25, XSLT vendor: Transformiix http://www.mozilla.org/projects/xslt/"><link rel="schema.dcterms" href="http://purl.org/dc/terms/"><meta name="dcterms.creator" content="Bierman, A."><meta name="dcterms.creator" content="Bjorklund, M."><meta name="dcterms.creator" content="Watsen, K."><meta name="dcterms.identifier" content="urn:ietf:id:draft-ietf-netconf-yang-patch-13"><meta name="dcterms.issued" content="2016-11-13"><meta name="dcterms.abstract" content="This document describes a method for applying patches to configuration datastores using data defined with the YANG data modeling language."><meta name="description" content="This document describes a method for applying patches to configuration datastores using data defined with the YANG data modeling language."></head><body><header><table class="header" id="rfc.headerblock"><tbody><tr><td class="left">Network Working Group</td><td class="right">A. Bierman</td></tr><tr><td class="left">Internet-Draft</td><td class="right">YumaWorks</td></tr><tr><td class="left">Intended status: Standards Track</td><td class="right">M. Bjorklund</td></tr><tr><td class="left">Expires: May 17, 2017</td><td class="right">Tail-f Systems</td></tr><tr><td class="left"></td><td class="right">K. Watsen</td></tr><tr><td class="left"></td><td class="right">Juniper Networks</td></tr><tr><td class="left"></td><td class="right">November 13, 2016</td></tr></tbody></table><div id="rfc.title"><h1>YANG Patch Media Type</h1><div class="filename">draft-ietf-netconf-yang-patch-13</div></div></header><section id="rfc.abstract"><h2><a href="#rfc.abstract">Abstract</a></h2><p>This
 document describes a method for applying patches to configuration 
datastores using data defined with the YANG data modeling language.</p></section><section id="rfc.status"><h2><a href="#rfc.status">Status of this Memo</a></h2><p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p><p>Internet-Drafts
 are working documents of the Internet Engineering Task Force (IETF). 
Note that other groups may also distribute working documents as 
Internet-Drafts. The list of current Internet-Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.</p><p>Internet-Drafts
 are draft documents valid for a maximum of six months and may be 
updated, replaced, or obsoleted by other documents at any time. It is 
inappropriate to use Internet-Drafts as reference material or to cite 
them other than as “work in progress”.</p><p>This Internet-Draft will expire on May 17, 2017.</p></section><section id="rfc.copyrightnotice"><h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2><p>Copyright © 2016 IETF Trust and the persons identified as the document authors. All rights reserved.</p><p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>)
 in effect on the date of publication of this document. Please review 
these documents carefully, as they describe your rights and restrictions
 with respect to this document. Code Components extracted from this 
document must include Simplified BSD License text as described in 
Section 4.e of the Trust Legal Provisions and are provided without 
warranty as described in the Simplified BSD License.</p></section><hr class="noprint"><nav id="rfc.toc"><h2 class="np"><a href="#rfc.toc">Table of Contents</a></h2><ul class="toc"><li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#introduction">Introduction</a><ul><li><a href="#rfc.section.1.1">1.1</a>&nbsp;&nbsp;&nbsp;<a href="#terminology">Terminology</a><ul><li><a href="#rfc.section.1.1.1">1.1.1</a>&nbsp;&nbsp;&nbsp;<a href="#netconf">NETCONF</a></li><li><a href="#rfc.section.1.1.2">1.1.2</a>&nbsp;&nbsp;&nbsp;<a href="#http">HTTP</a></li><li><a href="#rfc.section.1.1.3">1.1.3</a>&nbsp;&nbsp;&nbsp;<a href="#yang">YANG</a></li><li><a href="#rfc.section.1.1.4">1.1.4</a>&nbsp;&nbsp;&nbsp;<a href="#restconf">RESTCONF</a></li><li><a href="#rfc.section.1.1.5">1.1.5</a>&nbsp;&nbsp;&nbsp;<a href="#yang-patch">YANG Patch</a></li><li><a href="#rfc.section.1.1.6">1.1.6</a>&nbsp;&nbsp;&nbsp;<a href="#examples">Examples</a></li><li><a href="#rfc.section.1.1.7">1.1.7</a>&nbsp;&nbsp;&nbsp;<a href="#tree-diagram-notations">Tree Diagram Notations</a></li></ul></li></ul></li><li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#yang-patch-2">YANG Patch</a><ul><li><a href="#rfc.section.2.1">2.1</a>&nbsp;&nbsp;&nbsp;<a href="#target-resource">Target Resource</a></li><li><a href="#rfc.section.2.2">2.2</a>&nbsp;&nbsp;&nbsp;<a href="#yang-patch-request">yang-patch Request</a></li><li><a href="#rfc.section.2.3">2.3</a>&nbsp;&nbsp;&nbsp;<a href="#yang-patch-status-response">yang-patch-status Response</a></li><li><a href="#rfc.section.2.4">2.4</a>&nbsp;&nbsp;&nbsp;<a href="#target-data-node">Target Data Node</a></li><li><a href="#rfc.section.2.5">2.5</a>&nbsp;&nbsp;&nbsp;<a href="#edit-operations">Edit Operations</a></li><li><a href="#rfc.section.2.6">2.6</a>&nbsp;&nbsp;&nbsp;<a href="#successful-edit-response-handling">Successful Edit Response Handling</a></li><li><a href="#rfc.section.2.7">2.7</a>&nbsp;&nbsp;&nbsp;<a href="#error-handling">Error Handling</a></li><li><a href="#rfc.section.2.8">2.8</a>&nbsp;&nbsp;&nbsp;<a href="#yang-patch-restconf-capability">yang-patch RESTCONF Capability</a></li></ul></li><li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#module">YANG Module</a></li><li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#iana">IANA Considerations</a><ul><li><a href="#rfc.section.4.1">4.1</a>&nbsp;&nbsp;&nbsp;<a href="#yang-module-registry">YANG Module Registry</a></li><li><a href="#rfc.section.4.2">4.2</a>&nbsp;&nbsp;&nbsp;<a href="#media-types">Media Types</a><ul><li><a href="#rfc.section.4.2.1">4.2.1</a>&nbsp;&nbsp;&nbsp;<a href="#yang-patch-xml">Media Type application/yang-patch+xml</a></li><li><a href="#rfc.section.4.2.2">4.2.2</a>&nbsp;&nbsp;&nbsp;<a href="#yang-patch-json">Media Type application/yang-patch+json</a></li></ul></li><li><a href="#rfc.section.4.3">4.3</a>&nbsp;&nbsp;&nbsp;<a href="#capability-uri-def">RESTCONF Capability URNs</a></li></ul></li><li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#security-considerations">Security Considerations</a></li><li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">Normative References</a></li><li><a href="#rfc.section.A">A.</a>&nbsp;&nbsp;&nbsp;<a href="#acknowledgements">Acknowledgements</a></li><li><a href="#rfc.section.B">B.</a>&nbsp;&nbsp;&nbsp;<a href="#change-log">Change Log</a><ul><li><a href="#rfc.section.B.1">B.1</a>&nbsp;&nbsp;&nbsp;<a href="#v12-to-v13">v12 to v13</a></li><li><a href="#rfc.section.B.2">B.2</a>&nbsp;&nbsp;&nbsp;<a href="#v11-to-v12">v11 to v12</a></li><li><a href="#rfc.section.B.3">B.3</a>&nbsp;&nbsp;&nbsp;<a href="#v10-to-v11">v10 to v11</a></li><li><a href="#rfc.section.B.4">B.4</a>&nbsp;&nbsp;&nbsp;<a href="#v09-to-v10">v09 to v10</a></li><li><a href="#rfc.section.B.5">B.5</a>&nbsp;&nbsp;&nbsp;<a href="#v08-to-v09">v08 to v09</a></li><li><a href="#rfc.section.B.6">B.6</a>&nbsp;&nbsp;&nbsp;<a href="#v07-to-v08">v07 to v08</a></li><li><a href="#rfc.section.B.7">B.7</a>&nbsp;&nbsp;&nbsp;<a href="#v06-to-v07">v06 to v07</a></li><li><a href="#rfc.section.B.8">B.8</a>&nbsp;&nbsp;&nbsp;<a href="#v05-to-v06">v05 to v06</a></li><li><a href="#rfc.section.B.9">B.9</a>&nbsp;&nbsp;&nbsp;<a href="#v04-to-v05">v04 to v05</a></li><li><a href="#rfc.section.B.10">B.10</a>&nbsp;&nbsp;&nbsp;<a href="#v03-to-v04">v03 to v04</a></li><li><a href="#rfc.section.B.11">B.11</a>&nbsp;&nbsp;&nbsp;<a href="#v02-to-v03">v02 to v03</a></li><li><a href="#rfc.section.B.12">B.12</a>&nbsp;&nbsp;&nbsp;<a href="#v01-to-v02">v01 to v02</a></li><li><a href="#rfc.section.B.13">B.13</a>&nbsp;&nbsp;&nbsp;<a href="#v00-to-v01">v00 to v01</a></li><li><a href="#rfc.section.B.14">B.14</a>&nbsp;&nbsp;&nbsp;<a href="#biermanyang-patch-00-to-ietfyang-patch-00">bierman:yang-patch-00 to ietf:yang-patch-00</a></li></ul></li><li><a href="#rfc.section.C">C.</a>&nbsp;&nbsp;&nbsp;<a href="#open-issues">Open Issues</a></li><li><a href="#rfc.section.D">D.</a>&nbsp;&nbsp;&nbsp;<a href="#example-yang-module">Example YANG Module</a><ul><li><a href="#rfc.section.D.1">D.1</a>&nbsp;&nbsp;&nbsp;<a href="#yang-patch-examples">YANG Patch Examples</a><ul><li><a href="#rfc.section.D.1.1">D.1.1</a>&nbsp;&nbsp;&nbsp;<a href="#error-example">Add Resources: Error</a></li><li><a href="#rfc.section.D.1.2">D.1.2</a>&nbsp;&nbsp;&nbsp;<a href="#success-example">Add Resources: Success</a></li><li><a href="#rfc.section.D.1.3">D.1.3</a>&nbsp;&nbsp;&nbsp;<a href="#insert-list-entry-example">Insert list entry example</a></li><li><a href="#rfc.section.D.1.4">D.1.4</a>&nbsp;&nbsp;&nbsp;<a href="#move-list-entry-example">Move list entry example</a></li><li><a href="#rfc.section.D.1.5">D.1.5</a>&nbsp;&nbsp;&nbsp;<a href="#edit-datastore-resource-example">Edit datastore resource example</a></li></ul></li></ul></li><li><a href="#rfc.authors">Authors' Addresses</a></li></ul></nav><hr class="noprint"><section id="introduction"><h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a href="#introduction">Introduction</a></h2><div id="rfc.section.1.p.1"><p>There is a need for standard mechanisms to patch datastores defined in <a href="#RFC6241"><cite title="Network Configuration Protocol (NETCONF)">[RFC6241]</cite></a>, which contain conceptual data that conforms to schema specified with YANG <a href="#RFC7950"><cite title="The YANG 1.1 Data Modeling Language">[RFC7950]</cite></a>.
 An "ordered edit list" approach is needed to provide RESTCONF client 
developers with more precise RESTCONF client control of the edit 
procedure than existing mechanisms found in <a href="#I-D.ietf-netconf-restconf"><cite title="RESTCONF Protocol">[I-D.ietf-netconf-restconf]</cite></a>.</p></div><div id="rfc.section.1.p.2"><p>This document defines a media type for a YANG-based editing mechanism that can be used with the HTTP PATCH method <a href="#RFC5789"><cite title="PATCH Method for HTTP">[RFC5789]</cite></a>. YANG Patch is designed to support the RESTCONF protocol, defined in <a href="#I-D.ietf-netconf-restconf"><cite title="RESTCONF Protocol">[I-D.ietf-netconf-restconf]</cite></a>. This document only specifies the use of the YANG Patch media type with the RESTCONF protocol.</p></div><div id="rfc.section.1.p.3"><p>It
 may be possible to use YANG Patch with other protocols besides 
RESTCONF. This is outside the scope of this document. For any protocol 
which supports the YANG Patch media type, if the entire patch document 
cannot be successfully applied, then the server MUST NOT apply any of 
the changes. It may be possible to use YANG Patch with datastore types 
other than a configuration datastore. This is outside the scope of this 
document.</p></div><section id="terminology"><h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1</a>&nbsp;<a href="#terminology">Terminology</a></h3><div id="rfc.section.1.1.p.1"><p>The
 key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 
document are to be interpreted as described in <a href="#RFC2119"><cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>.</p></div><section id="netconf"><h4 id="rfc.section.1.1.1"><a href="#rfc.section.1.1.1">1.1.1</a>&nbsp;<a href="#netconf">NETCONF</a></h4><div id="rfc.section.1.1.1.p.1" class="avoidbreakafter"><p>The following terms are defined in <a href="#RFC6241"><cite title="Network Configuration Protocol (NETCONF)">[RFC6241]</cite></a>:</p></div><div id="rfc.section.1.1.1.p.2"><ul><li>configuration data</li><li>datastore</li><li>configuration datastore</li><li>protocol operation</li><li>running configuration datastore</li><li>state data</li><li>user</li></ul></div></section><section id="http"><h4 id="rfc.section.1.1.2"><a href="#rfc.section.1.1.2">1.1.2</a>&nbsp;<a href="#http">HTTP</a></h4><div id="rfc.section.1.1.2.p.1" class="avoidbreakafter"><p>The following terms are defined in <a href="#RFC7230"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">[RFC7230]</cite></a>:</p></div><div id="rfc.section.1.1.2.p.2"><ul><li>header field</li><li>message-body</li><li>query</li><li>request URI</li></ul></div><div id="rfc.section.1.1.2.p.3" class="avoidbreakafter"><p>The following terms are defined in <a href="#RFC7231"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a>:</p></div><div id="rfc.section.1.1.2.p.4"><ul><li>method</li><li>request</li><li>resource</li></ul></div></section><section id="yang"><h4 id="rfc.section.1.1.3"><a href="#rfc.section.1.1.3">1.1.3</a>&nbsp;<a href="#yang">YANG</a></h4><div id="rfc.section.1.1.3.p.1" class="avoidbreakafter"><p>The following terms are defined in <a href="#RFC7950"><cite title="The YANG 1.1 Data Modeling Language">[RFC7950]</cite></a>:</p></div><div id="rfc.section.1.1.3.p.2"><ul><li>container</li><li>data node</li><li>leaf</li><li>leaf-list</li><li>list</li><li>RPC operation (now called protocol operation)</li></ul></div></section><section id="restconf"><h4 id="rfc.section.1.1.4"><a href="#rfc.section.1.1.4">1.1.4</a>&nbsp;<a href="#restconf">RESTCONF</a></h4><div id="rfc.section.1.1.4.p.1" class="avoidbreakafter"><p>The following terms are defined in <a href="#I-D.ietf-netconf-restconf"><cite title="RESTCONF Protocol">[I-D.ietf-netconf-restconf]</cite></a>:</p></div><div id="rfc.section.1.1.4.p.2"><ul><li>application/yang-data+xml</li><li>application/yang-data+json</li><li>data resource</li><li>datastore resource</li><li>patch</li><li>RESTCONF capability</li><li>target resource</li><li>YANG data template</li></ul></div></section><section id="yang-patch"><h4 id="rfc.section.1.1.5"><a href="#rfc.section.1.1.5">1.1.5</a>&nbsp;<a href="#yang-patch">YANG Patch</a></h4><div id="rfc.section.1.1.5.p.1" class="avoidbreakafter"><p>The following terms are used within this document:</p></div><div id="rfc.section.1.1.5.p.2"><ul><li>RESTCONF client: a client which implements the RESTCONF protocol.</li><li>RESTCONF server: a server which implements the RESTCONF protocol.</li><li>YANG Patch: a conceptual edit request using the "yang‑patch" YANG Patch template, defined in <a href="#module" title="YANG Module">Section&nbsp;3</a>.
 In HTTP, refers to a PATCH method where a representation uses either 
the media type "application/yang‑patch+xml" or 
"application/yang‑patch+json".</li><li>YANG Patch Status: a conceptual edit status response using the YANG "yang‑patch‑status" YANG data template, defined in <a href="#module" title="YANG Module">Section&nbsp;3</a>.
 In HTTP, refers to a response message for a PATCH method, where it has a
 representation with either the media type "application/yang‑data+xml" 
or "application/yang‑data+json".</li><li>YANG Patch template: this is 
similar to a YANG data template, except it has a representation with the
 media type "application/yang‑patch+xml" or 
"application/yang‑patch+json".</li></ul></div></section><section id="examples"><h4 id="rfc.section.1.1.6"><a href="#rfc.section.1.1.6">1.1.6</a>&nbsp;<a href="#examples">Examples</a></h4><div id="rfc.section.1.1.6.p.1"><p>Some
 protocol message lines within examples throughout the document are 
split into multiple lines for display purposes only. When a line ends 
with backslash ('\') as the last character, the line is wrapped for 
display purposes. It is to be considered to be joined to the next line 
by deleting the backslash, the following line break, and the leading 
whitespace of the next line.</p></div></section><section id="tree-diagram-notations"><h4 id="rfc.section.1.1.7"><a href="#rfc.section.1.1.7">1.1.7</a>&nbsp;<a href="#tree-diagram-notations">Tree Diagram Notations</a></h4><div id="rfc.section.1.1.7.p.1" class="avoidbreakafter"><p>A
 simplified graphical representation of the data model is used in this 
document. The meaning of the symbols in these diagrams is as follows:</p></div><div id="rfc.section.1.1.7.p.2"><ul><li>Brackets "[" and "]" enclose list keys.</li><li>Abbreviations
 before data node names: "rw" means configuration data (read-write), 
"ro" state data (read-only), and "x" operation resource (executable)</li><li>Symbols after data node names: "?" means an optional node and "*" denotes a "list" and "leaf‑list".</li><li>Parentheses enclose choice and case nodes, and case nodes are also marked with a colon (":").</li><li>Ellipsis ("...") stands for contents of subtrees that are not shown.</li></ul></div></section></section></section><hr class="noprint"><section id="yang-patch-2"><h2 id="rfc.section.2" class="np"><a href="#rfc.section.2">2.</a>&nbsp;<a href="#yang-patch-2">YANG Patch</a></h2><div id="rfc.section.2.p.1"><p>A
 "YANG Patch" is an ordered list of edits that are applied to the target
 datastore by the RESTCONF server. The specific fields are defined in 
the YANG module in <a href="#module" title="YANG Module">Section&nbsp;3</a>.</p></div><div id="rfc.section.2.p.2"><p>The
 YANG Patch operation is invoked by the RESTCONF client by sending a 
PATCH method request with a representation using either the 
"application/yang‑patch+xml" or "application/yang‑patch+json" media 
type. This message-body representing the YANG Patch input parameters 
MUST be present.</p></div><div id="rfc.section.2.p.3" class="avoidbreakafter"><p>YANG Patch has some features that are not possible with the PATCH method in RESTCONF:</p></div><div id="rfc.section.2.p.4"><ul><li>YANG Patch allows multiple sub-resources to be edited within the same PATCH method.</li><li>YANG
 Patch allows more precise edit operations than RESTCONF. There are 7 
operations supported (create, delete, insert, merge, move, replace, 
remove).</li><li>YANG Patch uses an edit list with an explicit 
processing order. The edits are processed in client-specified order, and
 error processing can be precise even when multiple errors occur in the 
same patch request.</li></ul></div><div id="rfc.section.2.p.5"><p>The 
YANG Patch "patch‑id" may be useful for debugging, and SHOULD be present
 in any audit audit logging records generated by the RESTCONF server for
 a patch.</p></div><div id="rfc.section.2.p.6"><p>The RESTCONF server MUST return the Accept-Patch header field in an OPTIONS response, as specified in <a href="#RFC5789"><cite title="PATCH Method for HTTP">[RFC5789]</cite></a>,
 which includes the media type for YANG Patch. This is needed by a 
client to determine the message encoding formats supported by the server
 (e.g., XML, JSON, or both). An example is shown in Figure 1.</p></div><div id="rfc.figure.u.1"><pre>
  Accept-Patch: application/yang-patch+xml,application/yang-patch+json


               Figure 1: Example Accept-Patch header
	    </pre></div><div id="rfc.section.2.p.7"><p>Note that YANG Patch can
 only edit data resources. The PATCH method cannot be used to replace 
the datastore resource. Although the "ietf‑yang‑patch" YANG module is 
written using YANG version 1.1 <a href="#RFC7950"><cite title="The YANG 1.1 Data Modeling Language">[RFC7950]</cite></a>, an implementation of YANG Patch can be used with content defined in YANG version 1 <a href="#RFC6020"><cite title="YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)">[RFC6020]</cite></a> as well.</p></div><div id="rfc.section.2.p.8"><p>A YANG Patch can be encoded in XML format according to <a href="#W3C.REC-xml-20081126"><cite title="Extensible Markup Language (XML) 1.0 (Fifth Edition)">[W3C.REC-xml-20081126]</cite></a>. It can also be encoded in JSON, according to "JSON Encoding of Data Modeled with YANG" <a href="#RFC7951"><cite title="JSON Encoding of Data Modeled with YANG">[RFC7951]</cite></a>. If any meta-data needs to be sent in a JSON message, it is encoded according to "Defining and Using Metadata with YANG" <a href="#RFC7952"><cite title="Defining and Using Metadata with YANG">[RFC7952]</cite></a>.</p></div><section id="target-resource"><h3 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1</a>&nbsp;<a href="#target-resource">Target Resource</a></h3><div id="rfc.section.2.1.p.1"><p>The
 YANG Patch operation uses the RESTCONF target resource URI to identify 
the resource that will be patched. This can be the datastore resource 
itself, i.e., "{+restconf}/data", to edit top-level configuration data 
resources, or it can be a configuration data resource within the 
datastore resource, e.g., "{+restconf}/data/ietf‑interfaces:interfaces",
 to edit sub-resources within a top-level configuration data resource.</p></div><div id="rfc.section.2.1.p.2"><p>The
 target resource MUST identify exactly one resource instance. If more 
than one resource instance is identified, then the request MUST NOT be 
processed, and a "400 Bad Request" error response MUST be sent by the 
server. If the target resource does not identify any existing resource 
instance then the request MUST NOT be processed, and a "404 Not Found" 
error response MUST be sent by the server.</p></div><div id="rfc.section.2.1.p.3"><p>Each edit with a YANG Patch identifies a target data node for the associated edit. This is described in <a href="#target-data-node" title="Target Data Node">Section&nbsp;2.4</a>.</p></div></section><section id="yang-patch-request"><h3 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2</a>&nbsp;<a href="#yang-patch-request">yang-patch Request</a></h3><div id="rfc.section.2.2.p.1"><p>A
 YANG patch is optionally identified by a unique "patch‑id" and it may 
have an optional comment. A patch is an ordered collection of edits. 
Each edit is identified by an "edit‑id" and it has an edit operation 
(create, delete, insert, merge, move, replace, remove) that is applied 
to the target resource. Each edit can be applied to a sub-resource 
"target" within the target resource. If the operation is "insert" or 
"move", then the "where" parameter indicates how the node is inserted or
 moved. For values "before" and "after", the "point" parameter specifies
 the data node insertion point.</p></div><div id="rfc.section.2.2.p.2"><p>The
 merge, replace, create, delete, and remove edit operations have the 
exact same meaning as defined for the "operation" attribute in section 
7.2 of <a href="#RFC6241"><cite title="Network Configuration Protocol (NETCONF)">[RFC6241]</cite></a>.</p></div><div id="rfc.section.2.2.p.3"><p>Each
 edit within a YANG Patch MUST identify exactly one data resource 
instance. If an edit represents more than one resource instance, then 
the request MUST NOT be processed, and a "400 Bad Request" error 
response MUST be sent by the server. If the edit does not identify any 
existing resource instance, and the operation for the edit is not 
"create", then the request MUST NOT be processed, and a "404 Not Found" 
error response MUST be sent by the server. A "yang‑patch‑status" 
response MUST be sent by the server identifying the edit(s) that are not
 valid.</p></div><div id="rfc.section.2.2.p.4"><p>YANG Patch does not 
provide any access to specific datastores. It is an implementation 
detail how a server processes an edit if it is co-located with a NETCONF
 server that does provide access to individual datastores. A complete 
datastore cannot be replaced in the same manner as provided by the 
"copy‑config" operation defined in section 7.3 of <a href="#RFC6241"><cite title="Network Configuration Protocol (NETCONF)">[RFC6241]</cite></a>. Only the specified nodes in a YANG Patch are affected.</p></div><div id="rfc.section.2.2.p.5"><p>A
 message-body representing the YANG Patch is sent by the RESTCONF client
 to specify the edit operation request. When used with the HTTP PATCH 
method, this data is identified by the YANG Patch media type.</p></div><div id="rfc.section.2.2.p.6"><p>YANG tree diagram for "yang‑patch" Container</p></div><div id="rfc.figure.u.2"><pre>
  +---- yang-patch
        +---- patch-id    string
        +---- comment?    string
        +---- edit* [edit-id]
           +---- edit-id      string
           +---- operation    enumeration
           +---- target       target-resource-offset
           +---- point?       target-resource-offset
           +---- where?       enumeration
           +---- value?
	    </pre></div></section><section id="yang-patch-status-response"><h3 id="rfc.section.2.3"><a href="#rfc.section.2.3">2.3</a>&nbsp;<a href="#yang-patch-status-response">yang-patch-status Response</a></h3><div id="rfc.section.2.3.p.1"><p>A
 message-body representing the YANG Patch Status is returned to the 
RESTCONF client to report the detailed status of the edit operation. 
When used with the HTTP PATCH method, this data is identified by the 
YANG Patch Status media type, and the syntax specification is defined in
 <a href="#module" title="YANG Module">Section&nbsp;3</a>.</p></div><div id="rfc.section.2.3.p.2" class="avoidbreakafter"><p>YANG tree diagram for "yang‑patch‑status" Container:</p></div><div id="rfc.figure.u.3"><pre>
  +---- yang-patch-status
        +---- patch-id       string
        +---- (global-status)?
        |  +--:(global-errors)
        |  |  +---- errors
        |  |     +---- error*
        |  |        +---- error-type       enumeration
        |  |        +---- error-tag        string
        |  |        +---- error-app-tag?   string
        |  |        +---- error-path?      instance-identifier
        |  |        +---- error-message?   string
        |  |        +---- error-info?
        |  +--:(ok)
        |     +---- ok?            empty
        +---- edit-status
           +---- edit* [edit-id]
              +---- edit-id    string
              +---- (edit-status-choice)?
                 +--:(ok)
                 |  +---- ok?        empty
                 +--:(errors)
                    +---- errors
                       +---- error*
                          +---- error-type       enumeration
                          +---- error-tag        string
                          +---- error-app-tag?   string
                          +---- error-path?      instance-identifier
                          +---- error-message?   string
                          +---- error-info?
	    </pre></div></section><section id="target-data-node"><h3 id="rfc.section.2.4"><a href="#rfc.section.2.4">2.4</a>&nbsp;<a href="#target-data-node">Target Data Node</a></h3><div id="rfc.section.2.4.p.1"><p>The
 target data node for each edit operation is determined by the value of 
the target resource in the request and the "target" leaf within each 
"edit" entry.</p></div><div id="rfc.section.2.4.p.2"><p>If the target 
resource specified in the request URI identifies a datastore resource, 
then the path string in the "target" leaf is treated as an absolute path
 expression identifying the target data node for the corresponding edit.
 The first node specified in the "target" leaf is a top-level data node 
defined within a YANG module. The "target" leaf MUST NOT contain a 
single forward slash "/", since this would identify the datastore 
resource, not a data resource.</p></div><div id="rfc.section.2.4.p.3"><p>If
 the target resource specified in the request URI identifies a 
configuration data resource, then the path string in the "target" leaf 
is treated as a relative path expression. The first node specified in 
the "target" leaf is a child configuration data node of the data node 
associated with the target resource. If the "target" leaf contains a 
single forward slash "/", then the target data node is the target 
resource data node.</p></div></section><section id="edit-operations"><h3 id="rfc.section.2.5"><a href="#rfc.section.2.5">2.5</a>&nbsp;<a href="#edit-operations">Edit Operations</a></h3><div id="rfc.section.2.5.p.1"><p>Each
 YANG patch edit specifies one edit operation on the target data node. 
The set of operations is aligned with the NETCONF edit operations, but 
also includes some new operations.</p></div><div id="rfc.table.u.1"><table class="tt full tcenter"><caption>YANG Patch Edit Operations</caption><thead><tr><th class="left">Operation</th><th class="left">Description</th></tr></thead><tbody><tr><td class="left">create</td><td class="left">create a new data resource if it does not already exist or error</td></tr><tr><td class="left">delete</td><td class="left">delete a data resource if it already exists or error</td></tr><tr><td class="left">insert</td><td class="left">insert a new user-ordered data resource</td></tr><tr><td class="left">merge</td><td class="left">merge the edit value with the target data resource; create if it does not already exist</td></tr><tr><td class="left">move</td><td class="left">re-order the target data resource</td></tr><tr><td class="left">replace</td><td class="left">replace the target data resource with the edit value</td></tr><tr><td class="left">remove</td><td class="left">remove a data resource if it already exists</td></tr></tbody></table></div></section><section id="successful-edit-response-handling"><h3 id="rfc.section.2.6"><a href="#rfc.section.2.6">2.6</a>&nbsp;<a href="#successful-edit-response-handling">Successful Edit Response Handling</a></h3><div id="rfc.section.2.6.p.1"><p>If
 a YANG Patch is completed without errors, the RESTCONF server MUST 
return a "yang‑patch‑status" message with a global-status choice set to 
'ok'.</p></div><div id="rfc.section.2.6.p.2"><p>The RESTCONF server will
 save the running datastore to non-volatile storage if it supports 
non-volatile storage, and if the running datastore contents have 
changed, as specified in <a href="#I-D.ietf-netconf-restconf"><cite title="RESTCONF Protocol">[I-D.ietf-netconf-restconf]</cite></a>.</p></div><div id="rfc.section.2.6.p.3"><p>Refer to <a href="#success-example" title="Add Resources: Success">Appendix&nbsp;D.1.2</a> for a example of a successful YANG Patch response.</p></div></section><section id="error-handling"><h3 id="rfc.section.2.7"><a href="#rfc.section.2.7">2.7</a>&nbsp;<a href="#error-handling">Error Handling</a></h3><div id="rfc.section.2.7.p.1" class="avoidbreakafter"><p>If
 a well-formed, schema-valid YANG Patch message is received, then the 
RESTCONF server will process the supplied edits in ascending order. The 
following error modes apply to the processing of this edit list:</p></div><div id="rfc.section.2.7.p.2"><p>If
 a YANG Patch is completed with errors, the RESTCONF server SHOULD 
return a "yang‑patch‑status" message. It is possible (e.g., within a 
distributed implementation), that an invalid request will be rejected 
before the YANG patch edits are processed. In this case, the server MUST
 send the appropriate HTTP error response instead.</p></div><div id="rfc.section.2.7.p.3"><p>Refer to <a href="#error-example" title="Add Resources: Error">Appendix&nbsp;D.1.1</a> for a example of an error YANG Patch response.</p></div></section><section id="yang-patch-restconf-capability"><h3 id="rfc.section.2.8"><a href="#rfc.section.2.8">2.8</a>&nbsp;<a href="#yang-patch-restconf-capability">yang-patch RESTCONF Capability</a></h3><div id="rfc.section.2.8.p.1"><p>A
 URI is defined to identify the YANG Patch extension to the base 
RESTCONF protocol. If the RESTCONF server supports the YANG Patch media 
type, then the "yang‑patch" RESTCONF capability defined in <a href="#capability-uri-def" title="RESTCONF Capability URNs">Section&nbsp;4.3</a> MUST be present in the "capability" leaf-list in the "ietf‑restconf‑monitoring" module defined in <a href="#I-D.ietf-netconf-restconf"><cite title="RESTCONF Protocol">[I-D.ietf-netconf-restconf]</cite></a>.</p></div></section></section><hr class="noprint"><section id="module"><h2 id="rfc.section.3" class="np"><a href="#rfc.section.3">3.</a>&nbsp;<a href="#module">YANG Module</a></h2><div id="rfc.section.3.p.1"><p>The
 "ietf‑yang‑patch" module defines conceptual definitions with the 
'yang‑data' extension statements, which are not meant to be implemented 
as datastore contents by a RESTCONF server.</p></div><div id="rfc.section.3.p.2"><p>The "ietf‑restconf" module from <a href="#I-D.ietf-netconf-restconf"><cite title="RESTCONF Protocol">[I-D.ietf-netconf-restconf]</cite></a> is used by this module for the 'yang‑data' extension definition.</p></div><div id="rfc.section.3.p.3"><p>RFC Ed.: update the date below with the date of RFC publication and remove this note.</p></div><div id="rfc.section.3.p.4"><p>&lt;CODE BEGINS&gt; file "ietf-yang-patch@2016-11-09.yang"</p></div><div id="rfc.figure.u.4"><pre>
module ietf-yang-patch {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-yang-patch";
  prefix "ypatch";

  import ietf-restconf { prefix rc; }

  organization
    "IETF NETCONF (Network Configuration) Working Group";

  contact
    "WG Web:   &lt;http://tools.ietf.org/wg/netconf/&gt;
     WG List:  &lt;mailto:netconf@ietf.org&gt;

     Author:   Andy Bierman
               &lt;mailto:andy@yumaworks.com&gt;

     Author:   Martin Bjorklund
               &lt;mailto:mbj@tail-f.com&gt;

     Author:   Kent Watsen
               &lt;mailto:kwatsen@juniper.net&gt;";

  description
    "This module contains conceptual YANG specifications
     for the YANG Patch and YANG Patch Status data structures.

     Note that the YANG definitions within this module do not
     represent configuration data of any kind.
     The YANG grouping statements provide a normative syntax
     for XML and JSON message encoding purposes.

     Copyright (c) 2016 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD License
     set forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (http://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC XXXX; see
     the RFC itself for full legal notices.";

  // RFC Ed.: replace XXXX with actual RFC number and remove this
  // note.

  // RFC Ed.: remove this note
  // Note: extracted from draft-ietf-netconf-yang-patch-13.txt

  // RFC Ed.: update the date below with the date of RFC publication
  // and remove this note.
  revision 2016-11-09 {
    description
      "Initial revision.";
    reference
      "RFC XXXX: YANG Patch Media Type.";
  }

  typedef target-resource-offset {
    type string;
    description
      "Contains a data resource identifier string representing
       a sub-resource within the target resource.
       The document root for this expression is the
       target resource that is specified in the
       protocol operation (e.g., the URI for the PATCH request).

       This string is encoded according the same rules as
       a data resource identifier in a RESTCONF Request URI.";

  // RFC Ed.: replace "draft-ietf-netconf-restconf" below
  // with RFC XXXX, where XXXX is the number of the RESTCONF RFC,
  // and remove this note.

    reference
       "draft-ietf-netconf-restconf, section 3.5.3";
  }

  rc:yang-data "yang-patch" {
    uses yang-patch;
  }

  rc:yang-data "yang-patch-status" {
    uses yang-patch-status;
  }

  grouping yang-patch {

    description
      "A grouping that contains a YANG container
       representing the syntax and semantics of a
       YANG Patch edit request message.";

    container yang-patch {
      description
        "Represents a conceptual sequence of datastore edits,
         called a patch. Each patch is given a client-assigned
         patch identifier. Each edit MUST be applied
         in ascending order, and all edits MUST be applied.
         If any errors occur, then the target datastore MUST NOT
         be changed by the patch operation.

         YANG datastore validation is performed before any edits
         have been applied to the running datastore.

         It is possible for a datastore constraint violation to occur
         due to any node in the datastore, including nodes not
         included in the edit list. Any validation errors MUST
         be reported in the reply message.";

      reference
        "RFC 7950, section 8.3.";

      leaf patch-id {
        type string;
        mandatory true;
        description
          "An arbitrary string provided by the client to identify
           the entire patch.  Error messages returned by the server
           pertaining to this patch will be identified by this
           patch-id value. A client SHOULD attempt to generate
           unique patch-id values to distinguish between transactions
           from multiple clients in any audit logs maintained
           by the server.";
      }

      leaf comment {
        type string;
        description
          "An arbitrary string provided by the client to describe
           the entire patch.  This value SHOULD be present in any
           audit logging records generated by the server for the
           patch.";
      }

      list edit {
        key edit-id;
        ordered-by user;

        description
          "Represents one edit within the YANG Patch
           request message.  The edit list is applied
           in the following manner:

             - The first edit is conceptually applied to a copy
               of the existing target datastore, e.g., the
               running configuration datastore.
             - Each ascending edit is conceptually applied to
               the result of the previous edit(s).
             - After all edits have been successfully processed,
               the result is validated according to YANG constraints.
             - If successful, the server will attempt to apply
               the result to the target datastore. ";

        leaf edit-id {
          type string;
          description
            "Arbitrary string index for the edit.
             Error messages returned by the server pertaining
             to a specific edit will be identified by this
             value.";
        }

        leaf operation {
          type enumeration {
            enum create {
              description
                "The target data node is created using the supplied
                 value, only if it does not already exist. The
                 'target' leaf identifies the data node to be created,
                 not the parent data node.";
            }
            enum delete {
              description
                "Delete the target node, only if the data resource
                 currently exists, otherwise return an error.";
            }
            enum insert {
              description
                "Insert the supplied value into a user-ordered
                 list or leaf-list entry. The target node must
                 represent a new data resource. If the 'where'
                 parameter is set to 'before' or 'after', then
                 the 'point' parameter identifies the insertion
                 point for the target node.";
            }
            enum merge {
              description
                "The supplied value is merged with the target data
                 node.";
            }
            enum move {
              description
                "Move the target node. Reorder a user-ordered
                 list or leaf-list. The target node must represent
                 an existing data resource. If the 'where' parameter
                 is set to 'before' or 'after', then the 'point'
                 parameter identifies the insertion point to move
                 the target node.";
            }
            enum replace {
              description
                "The supplied value is used to replace the target
                 data node.";
            }
            enum remove {
              description
                "Delete the target node if it currently exists.";
            }
          }
          mandatory true;
          description
            "The datastore operation requested for the associated
             edit entry";
        }

        leaf target {
          type target-resource-offset;
          mandatory true;
          description
            "Identifies the target data node for the edit
             operation. If the target has the value '/', then
             the target data node is the target resource.
             The target node MUST identify a data resource,
             not the datastore resource.";
        }

        leaf point {
          when "(../operation = 'insert' or ../operation = 'move') "
             + "and (../where = 'before' or ../where = 'after')" {
            description
              "Point leaf only applies for insert or move
               operations, before or after an existing entry.";
          }
          type target-resource-offset;
          description
            "The absolute URL path for the data node that is being
             used as the insertion point or move point for the
             target of this edit entry.";
        }

        leaf where {
          when "../operation = 'insert' or ../operation = 'move'" {
            description
              "Where leaf only applies for insert or move
               operations.";
          }
          type enumeration {
            enum before {
              description
                "Insert or move a data node before the data resource
                 identified by the 'point' parameter.";
            }
            enum after {
              description
                "Insert or move a data node after the data resource
                 identified by the 'point' parameter.";
            }
            enum first {
              description
                "Insert or move a data node so it becomes ordered
                 as the first entry.";
            }
            enum last {
              description
                "Insert or move a data node so it becomes ordered
                 as the last entry.";
            }
          }
          default last;
          description
            "Identifies where a data resource will be inserted or
             moved. YANG only allows these operations for
             list and leaf-list data nodes that are ordered-by
             user.";
        }

        anydata value {
          when "../operation = 'create' "
             + "or ../operation = 'merge' "
             + "or ../operation = 'replace' "
             + "or ../operation = 'insert'" {
            description
              "Value node only used for create, merge,
               replace, and insert operations";
          }
          description
            "Value used for this edit operation.  The anydata 'value'
             contains the target resource associated with the
             'target' leaf.

             For example, suppose the target node is a YANG container
             named foo:

                 container foo {
                   leaf a { type string; }
                   leaf b { type int32; }
                 }

             The 'value' node contains one instance of foo:

                 &lt;value&gt;
                    &lt;foo xmlns='example-foo-namespace'&gt;
                       &lt;a&gt;some value&lt;/a&gt;
                       &lt;b&gt;42&lt;/b&gt;
                    &lt;/foo&gt;
                 &lt;/value&gt;
              ";
        }
      }
    }

  } // grouping yang-patch


  grouping yang-patch-status {

    description
      "A grouping that contains a YANG container
       representing the syntax and semantics of
       YANG Patch status response message.";

    container yang-patch-status {
      description
        "A container representing the response message
         sent by the server after a YANG Patch edit
         request message has been processed.";

      leaf patch-id {
        type string;
        description
          "The patch-id value used in the request.
           If there was no patch-id present in the request
           then this field will not be present.";
      }

      choice global-status {
        description
          "Report global errors or complete success.
           If there is no case selected then errors
           are reported in the edit-status container.";

        case global-errors {
          uses rc:errors;
          description
            "This container will be present if global
             errors that are unrelated to a specific edit
             occurred.";
        }
        leaf ok {
          type empty;
          description
            "This leaf will be present if the request succeeded
             and there are no errors reported in the edit-status
             container.";
        }
      }

      container edit-status {
        description
          "This container will be present if there are
           edit-specific status responses to report.
           If all edits succeeded and the 'global-status'
           returned  is 'ok', then a server MAY omit this
           container";

        list edit {
          key edit-id;

          description
            "Represents a list of status responses,
             corresponding to edits in the YANG Patch
             request message.  If an edit entry was
             skipped or not reached by the server,
             then this list will not contain a corresponding
             entry for that edit.";

          leaf edit-id {
            type string;
             description
               "Response status is for the edit list entry
                with this edit-id value.";
          }
          choice edit-status-choice {
            description
              "A choice between different types of status
               responses for each edit entry.";
            leaf ok {
              type empty;
              description
                "This edit entry was invoked without any
                 errors detected by the server associated
                 with this edit.";
            }
            case errors {
              uses rc:errors;
              description
                "The server detected errors associated with the
                  edit identified by the same edit-id value.";
            }
          }
        }
      }
    }
  }  // grouping yang-patch-status

}
	    </pre></div><div id="rfc.section.3.p.5"><p>&lt;CODE ENDS&gt;</p></div></section><hr class="noprint"><section id="iana"><h2 id="rfc.section.4" class="np"><a href="#rfc.section.4">4.</a>&nbsp;<a href="#iana">IANA Considerations</a></h2><section id="yang-module-registry"><h3 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1</a>&nbsp;<a href="#yang-module-registry">YANG Module Registry</a></h3><div id="rfc.section.4.1.p.1"><p>This document registers one URI as a namespace in the IETF XML registry <a href="#RFC3688"><cite title="The IETF XML Registry">[RFC3688]</cite></a>. Following the format in RFC 3688, the following registration is requested to be made.</p></div><div id="rfc.figure.u.5"><pre>
      URI: urn:ietf:params:xml:ns:yang:ietf-yang-patch
      Registrant Contact: The NETCONF WG of the IETF.
      XML: N/A, the requested URI is an XML namespace.
	    </pre></div><div id="rfc.section.4.1.p.2"><p>This document registers one YANG module in the YANG Module Names registry <a href="#RFC6020"><cite title="YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)">[RFC6020]</cite></a>.</p></div><div id="rfc.figure.u.6"><pre>
      name:         ietf-yang-patch
      namespace:    urn:ietf:params:xml:ns:yang:ietf-yang-patch
      prefix:       ypatch
      // RFC Ed.: replace XXXX with RFC number and remove this note
      reference:    RFC XXXX
	    </pre></div></section><section id="media-types"><h3 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2</a>&nbsp;<a href="#media-types">Media Types</a></h3><section id="yang-patch-xml"><h4 id="rfc.section.4.2.1"><a href="#rfc.section.4.2.1">4.2.1</a>&nbsp;<a href="#yang-patch-xml">Media Type application/yang-patch+xml</a></h4><div id="rfc.figure.u.7"><pre>
   Type name: application

   Subtype name: yang-patch+xml

   Required parameters: None

   Optional parameters: None

  // RFC Ed.: replace 'XXXX' with the real RFC number,
  // and remove this note

   Encoding considerations: 8-bit
      Each conceptual YANG data node is encoded according to the
      XML Encoding Rules and Canonical Format for the specific
      YANG data node type defined in [RFC7950].
      In addition, the "yang-patch" YANG Patch template found
      in [RFCXXXX] defines the structure of a YANG Patch request.

  // RFC Ed.: replace 'NN' in Section NN of [RFCXXXX] with the
  // section number for Security Considerations
  // Replace 'XXXX' in Section NN of [RFCXXXX] with the actual
  // RFC number, and remove this note.

   Security considerations: Security considerations related
      to the generation and consumption of RESTCONF messages
      are discussed in Section NN of [RFCXXXX].
      Additional security considerations are specific to the
      semantics of particular YANG data models. Each YANG module
      is expected to specify security considerations for the
      YANG data defined in that module.

  // RFC Ed.: replace XXXX with actual RFC number and remove this
  // note.

   Interoperability considerations: [RFCXXXX] specifies the format
      of conforming messages and the interpretation thereof.

  // RFC Ed.: replace XXXX with actual RFC number and remove this
  // note.

   Published specification: RFC XXXX

   Applications that use this media type: Instance document
     data parsers used within a protocol or automation tool
     that utilize the YANG Patch data structure.

   Fragment identifier considerations: Same as for application/xml

   Additional information:

     Deprecated alias names for this type: N/A
     Magic number(s): N/A
     File extension(s): None
     Macintosh file type code(s): "TEXT"

  // RFC Ed.: replace XXXX with actual RFC number and remove this
  // note.

   Person &amp; email address to contact for further information: See
      Authors' Addresses section of [RFCXXXX].

   Intended usage: COMMON

   Restrictions on usage: N/A

  // RFC Ed.: replace XXXX with actual RFC number and remove this
  // note.

   Author: See Authors' Addresses section of [RFCXXXX].

   Change controller: Internet Engineering Task Force
      (mailto:iesg&amp;ietf.org).

   Provisional registration? (standards tree only): no
	    </pre></div></section><section id="yang-patch-json"><h4 id="rfc.section.4.2.2"><a href="#rfc.section.4.2.2">4.2.2</a>&nbsp;<a href="#yang-patch-json">Media Type application/yang-patch+json</a></h4><div id="rfc.figure.u.8"><pre>
   Type name: application

   Subtype name: yang-patch+json

   Required parameters: None

   Optional parameters: None

  // RFC Ed.: replace draft-ietf-netmod-yang-json with
  // the actual RFC reference for JSON Encoding of YANG Data,
  //  and remove this note.

  // RFC Ed.: replace draft-ietf-netmod-yang-metadata with
  // the actual RFC reference for JSON Encoding of YANG Data,
  //  and remove this note.

  // RFC Ed.: replace 'XXXX' with the real RFC number,
  // and remove this note

   Encoding considerations: 8-bit
      Each conceptual YANG data node is encoded according to
      [draft-ietf-netmod-yang-json]. A data annotation is
      encoded according to [draft-ietf-netmod-yang-metadata]
      In addition, the "yang-patch" YANG Patch template found
      in [RFCXXXX] defines the structure of a YANG Patch request.

  // RFC Ed.: replace 'NN' in Section NN of [RFCXXXX] with the
  // section number for Security Considerations
  // Replace 'XXXX' in Section NN of [RFCXXXX] with the actual
  // RFC number, and remove this note.

   Security considerations: Security considerations related
      to the generation and consumption of RESTCONF messages
      are discussed in Section NN of [RFCXXXX].
      Additional security considerations are specific to the
      semantics of particular YANG data models. Each YANG module
      is expected to specify security considerations for the
      YANG data defined in that module.

  // RFC Ed.: replace XXXX with actual RFC number and remove this
  // note.

   Interoperability considerations: [RFCXXXX] specifies the format
      of conforming messages and the interpretation thereof.

  // RFC Ed.: replace XXXX with actual RFC number and remove this
  // note.

   Published specification: RFC XXXX

   Applications that use this media type: Instance document
     data parsers used within a protocol or automation tool
     that utilize the YANG Patch data structure.

   Fragment identifier considerations: The syntax and semantics
      of fragment identifiers are the same as specified for the
     "application/json" media type.

   Additional information:

     Deprecated alias names for this type: N/A
     Magic number(s): N/A
     File extension(s): None
     Macintosh file type code(s): "TEXT"

  // RFC Ed.: replace XXXX with actual RFC number and remove this
  // note.

   Person &amp; email address to contact for further information: See
      Authors' Addresses section of [RFCXXXX].

   Intended usage: COMMON

   Restrictions on usage: N/A

  // RFC Ed.: replace XXXX with actual RFC number and remove this
  // note.

   Author: See Authors' Addresses section of [RFCXXXX].

   Change controller: Internet Engineering Task Force
      (mailto:iesg&amp;ietf.org).

   Provisional registration? (standards tree only): no
	    </pre></div></section></section><section id="capability-uri-def"><h3 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3</a>&nbsp;<a href="#capability-uri-def">RESTCONF Capability URNs</a></h3><div id="rfc.section.4.3.p.1"><p>This document registers one capability identifier in "RESTCONF Protocol Capability URNs" registry</p></div><div id="rfc.figure.u.9"><pre>
  Index
     Capability Identifier
  ------------------------

  :yang-patch
      urn:ietf:params:restconf:capability:yang-patch:1.0
	    </pre></div></section></section><hr class="noprint"><section id="security-considerations"><h2 id="rfc.section.5" class="np"><a href="#rfc.section.5">5.</a>&nbsp;<a href="#security-considerations">Security Considerations</a></h2><div id="rfc.section.5.p.1"><p>The YANG Patch media type does not introduce any significant new security threats, beyond what is described in <a href="#I-D.ietf-netconf-restconf"><cite title="RESTCONF Protocol">[I-D.ietf-netconf-restconf]</cite></a>. This document defines edit processing instructions for a variant of the PATCH method, as used within the RESTCONF protocol.</p></div><div id="rfc.section.5.p.2"><p>It may be possible to use YANG Patch with other protocols besides RESTCONF, which is outside the scope of this document.</p></div><div id="rfc.section.5.p.3"><p>For RESTCONF, both the client and server MUST be authenticated, according to section 2 of <a href="#I-D.ietf-netconf-restconf"><cite title="RESTCONF Protocol">[I-D.ietf-netconf-restconf]</cite></a>.
 It is important for RESTCONF server implementations to carefully 
validate all the edit request parameters in some manner. If the entire 
YANG Patch request cannot be completed, then no configuration changes to
 the system are done. A PATCH request MUST be applied atomically, as 
specified in section 2 of <a href="#RFC5789"><cite title="PATCH Method for HTTP">[RFC5789]</cite></a>.</p></div><div id="rfc.section.5.p.4"><p>A
 RESTCONF server implementation SHOULD attempt to prevent system 
disruption due to incremental processing of the YANG Patch edit list. It
 may be possible to construct an attack on such a RESTCONF server, which
 relies on the edit processing order mandated by YANG Patch. A server 
SHOULD apply only the fully validated configuration to the underlying 
system. For example, an edit list which deleted an interface and then 
recreated it could cause system disruption if the edit list was 
incrementally applied.</p></div><div id="rfc.section.5.p.5"><p>A 
RESTCONF server implementation SHOULD attempt to prevent system 
disruption due to excessive resource consumption required to fulfill 
YANG Patch edit requests. It may be possible to construct an attack on 
such a RESTCONF server, which attempts to consume all available memory 
or other resource types.</p></div></section><section id="rfc.references" class="np"><h2 id="rfc.section.6"><a href="#rfc.section.6">6.</a> Normative References</h2><dl class="reference"><dt id="I-D.ietf-netconf-restconf">[I-D.ietf-netconf-restconf]</dt><dd>Bierman, A., Bjorklund, M., and K. Watsen, “<a href="https://tools.ietf.org/html/draft-ietf-netconf-restconf-18">RESTCONF Protocol</a>”, Internet-Draft&nbsp;draft-ietf-netconf-restconf-18 (work in progress), October&nbsp;2016.</dd><dt id="RFC2119">[RFC2119]</dt><dd>Bradner, S., “<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>”, BCP&nbsp;14, RFC&nbsp;2119, <a href="http://dx.doi.org/10.17487/RFC2119">DOI&nbsp;10.17487/RFC2119</a>, March&nbsp;1997, &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.</dd><dt id="RFC3688">[RFC3688]</dt><dd>Mealling, M., “<a href="https://tools.ietf.org/html/rfc3688">The IETF XML Registry</a>”, BCP&nbsp;81, RFC&nbsp;3688, <a href="http://dx.doi.org/10.17487/RFC3688">DOI&nbsp;10.17487/RFC3688</a>, January&nbsp;2004, &lt;<a href="http://www.rfc-editor.org/info/rfc3688">http://www.rfc-editor.org/info/rfc3688</a>&gt;.</dd><dt id="RFC5789">[RFC5789]</dt><dd>Dusseault, L. and J. Snell, “<a href="https://tools.ietf.org/html/rfc5789">PATCH Method for HTTP</a>”, RFC&nbsp;5789, <a href="http://dx.doi.org/10.17487/RFC5789">DOI&nbsp;10.17487/RFC5789</a>, March&nbsp;2010, &lt;<a href="http://www.rfc-editor.org/info/rfc5789">http://www.rfc-editor.org/info/rfc5789</a>&gt;.</dd><dt id="RFC6020">[RFC6020]</dt><dd>Bjorklund, M., “<a href="https://tools.ietf.org/html/rfc6020">YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)</a>”, RFC&nbsp;6020, <a href="http://dx.doi.org/10.17487/RFC6020">DOI&nbsp;10.17487/RFC6020</a>, October&nbsp;2010, &lt;<a href="http://www.rfc-editor.org/info/rfc6020">http://www.rfc-editor.org/info/rfc6020</a>&gt;.</dd><dt id="RFC6241">[RFC6241]</dt><dd>Enns, R., Ed., Bjorklund, M., Ed., Schoenwaelder, J., Ed., and A. Bierman, Ed., “<a href="https://tools.ietf.org/html/rfc6241">Network Configuration Protocol (NETCONF)</a>”, RFC&nbsp;6241, <a href="http://dx.doi.org/10.17487/RFC6241">DOI&nbsp;10.17487/RFC6241</a>, June&nbsp;2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6241">http://www.rfc-editor.org/info/rfc6241</a>&gt;.</dd><dt id="RFC7159">[RFC7159]</dt><dd>Bray, T., Ed., “<a href="https://tools.ietf.org/html/rfc7159">The JavaScript Object Notation (JSON) Data Interchange Format</a>”, RFC&nbsp;7159, <a href="http://dx.doi.org/10.17487/RFC7159">DOI&nbsp;10.17487/RFC7159</a>, March&nbsp;2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7159">http://www.rfc-editor.org/info/rfc7159</a>&gt;.</dd><dt id="RFC7230">[RFC7230]</dt><dd>Fielding, R., Ed. and J. Reschke, Ed., “<a href="https://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>”, RFC&nbsp;7230, <a href="http://dx.doi.org/10.17487/RFC7230">DOI&nbsp;10.17487/RFC7230</a>, June&nbsp;2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7230">http://www.rfc-editor.org/info/rfc7230</a>&gt;.</dd><dt id="RFC7231">[RFC7231]</dt><dd>Fielding, R. and J. Reschke, “<a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>”, RFC&nbsp;7231, <a href="http://dx.doi.org/10.17487/RFC7231">DOI&nbsp;10.17487/RFC7231</a>, June&nbsp;2014, &lt;<a href="http://www.rfc-editor.org/info/rfc7231">http://www.rfc-editor.org/info/rfc7231</a>&gt;.</dd><dt id="RFC7950">[RFC7950]</dt><dd>Bjorklund, M., Ed., “<a href="https://tools.ietf.org/html/rfc7950">The YANG 1.1 Data Modeling Language</a>”, RFC&nbsp;7950, <a href="http://dx.doi.org/10.17487/RFC7950">DOI&nbsp;10.17487/RFC7950</a>, August&nbsp;2016, &lt;<a href="http://www.rfc-editor.org/info/rfc7950">http://www.rfc-editor.org/info/rfc7950</a>&gt;.</dd><dt id="RFC7951">[RFC7951]</dt><dd>Lhotka, L., “<a href="https://tools.ietf.org/html/rfc7951">JSON Encoding of Data Modeled with YANG</a>”, RFC&nbsp;7951, <a href="http://dx.doi.org/10.17487/RFC7951">DOI&nbsp;10.17487/RFC7951</a>, August&nbsp;2016, &lt;<a href="http://www.rfc-editor.org/info/rfc7951">http://www.rfc-editor.org/info/rfc7951</a>&gt;.</dd><dt id="RFC7952">[RFC7952]</dt><dd>Lhotka, L., “<a href="https://tools.ietf.org/html/rfc7952">Defining and Using Metadata with YANG</a>”, RFC&nbsp;7952, <a href="http://dx.doi.org/10.17487/RFC7952">DOI&nbsp;10.17487/RFC7952</a>, August&nbsp;2016, &lt;<a href="http://www.rfc-editor.org/info/rfc7952">http://www.rfc-editor.org/info/rfc7952</a>&gt;.</dd><dt id="W3C.REC-xml-20081126">[W3C.REC-xml-20081126]</dt><dd>Yergeau, F., Maler, E., Paoli, J., Sperberg-McQueen, C., and T. Bray, “<a href="http://www.w3.org/TR/2008/REC-xml-20081126">Extensible Markup Language (XML) 1.0 (Fifth Edition)</a>”, World Wide Web Consortium Recommendation&nbsp;REC-xml-20081126, November&nbsp;2008, &lt;<a href="http://www.w3.org/TR/2008/REC-xml-20081126">http://www.w3.org/TR/2008/REC-xml-20081126</a>&gt;.</dd></dl></section><hr class="noprint"><section id="acknowledgements"><h2 id="rfc.section.A" class="np"><a href="#rfc.section.A">A.</a>&nbsp;<a href="#acknowledgements">Acknowledgements</a></h2><div id="rfc.section.A.p.1"><p>The authors would like to thank the following people for their contributions to this document: Rex Fernando.</p></div><div id="rfc.section.A.p.2"><p>Contributions
 to this material by Andy Bierman are based upon work supported by the 
The Space &amp; Terrestrial Communications Directorate (S&amp;TCD) under
 Contract No. W15P7T-13-C-A616. Any opinions, findings and conclusions 
or recommendations expressed in this material are those of the author(s)
 and do not necessarily reflect the views of The Space &amp; Terrestrial
 Communications Directorate (S&amp;TCD).</p></div></section><hr class="noprint"><section id="change-log"><h2 id="rfc.section.B" class="np"><a href="#rfc.section.B">B.</a>&nbsp;<a href="#change-log">Change Log</a></h2><div id="rfc.figure.u.10"><pre>
    -- RFC Ed.: remove this section before publication.
	    </pre></div><div id="rfc.section.B.p.1"><p>The YANG Patch issue tracker can be found here: https://github.com/netconf-wg/yang-patch/issues</p></div><section id="v12-to-v13"><h3 id="rfc.section.B.1"><a href="#rfc.section.B.1">B.1</a>&nbsp;<a href="#v12-to-v13">v12 to v13</a></h3><div id="rfc.section.B.1.p.1"><ul><li>clarifications based on IESG reviews</li></ul></div></section><section id="v11-to-v12"><h3 id="rfc.section.B.2"><a href="#rfc.section.B.2">B.2</a>&nbsp;<a href="#v11-to-v12">v11 to v12</a></h3><div id="rfc.section.B.2.p.1"><ul><li>clarify target resource must exist</li><li>fix errors in some examples</li><li>change application/yang-patch-xml to application/yang-patch+xml</li><li>clarified some section titles</li><li>clarified error responses for multiple edit instances</li><li>made patch-id field mandatory</li><li>referenced NETCONF operation attribute</li></ul></div></section><section id="v10-to-v11"><h3 id="rfc.section.B.3"><a href="#rfc.section.B.3">B.3</a>&nbsp;<a href="#v10-to-v11">v10 to v11</a></h3><div id="rfc.section.B.3.p.1"><ul><li>change application/yang-patch to application/yang-patch-xml</li><li>change server to RESTCONF server and remove NETCONF server term</li><li>change client to RESTCONF client and remove NETCONF client term</li><li>clarified that YANG 1.0 content can be used in a YANG Patch implementation</li><li>clarified more terminology</li><li>fixed missing keys in edit examples</li><li>added insert list example</li></ul></div></section><section id="v09-to-v10"><h3 id="rfc.section.B.4"><a href="#rfc.section.B.4">B.4</a>&nbsp;<a href="#v09-to-v10">v09 to v10</a></h3><div id="rfc.section.B.4.p.1"><ul><li>change yang-patch+xml to yang-patch</li><li>clarify application/yang-patch+json media type</li><li>add edit datastore example</li><li>change data-resource-offset typedef so it is consistent for XML and JSON</li></ul></div></section><section id="v08-to-v09"><h3 id="rfc.section.B.5"><a href="#rfc.section.B.5">B.5</a>&nbsp;<a href="#v08-to-v09">v08 to v09</a></h3><div id="rfc.section.B.5.p.1"><ul><li>change RFC 7158 reference to RFC 7159 reference</li><li>change RFC 2616 reference to RFC 7230 reference</li><li>remove unused HTTP terms</li><li>remove import-by-revision of ietf-restconf; not needed</li><li>change application/yang.patch media type to application/yang-patch</li><li>remove application/yang.patch-status media type; use application/yang-data instead</li></ul></div></section><section id="v07-to-v08"><h3 id="rfc.section.B.6"><a href="#rfc.section.B.6">B.6</a>&nbsp;<a href="#v07-to-v08">v07 to v08</a></h3><div id="rfc.section.B.6.p.1"><ul><li>clarified target datastore and target data node terms</li><li>clarified that target leaf can be single forward slash '/'</li><li>added Successful edit response handling section</li><li>clarified that YANG Patch draft is for RESTCONF protocol only but may be defined for other protocols outside this document</li><li>clarified
 that YANG Patch draft is for configuration datastores only but may be 
defined for other datastore types outside this document</li><li>fixed typos</li></ul></div></section><section id="v06-to-v07"><h3 id="rfc.section.B.7"><a href="#rfc.section.B.7">B.7</a>&nbsp;<a href="#v06-to-v07">v06 to v07</a></h3><div id="rfc.section.B.7.p.1"><ul><li>converted YANG module to YANG 1.1</li><li>changed anyxml value to anydata value</li><li>updated import revision date for ietf-restconf</li><li>updated revision date for ietf-yang-patch because import-by-revision date needed to be changed</li></ul></div></section><section id="v05-to-v06"><h3 id="rfc.section.B.8"><a href="#rfc.section.B.8">B.8</a>&nbsp;<a href="#v05-to-v06">v05 to v06</a></h3><div id="rfc.section.B.8.p.1"><ul><li>changed errors example so a full request and error response is shown in XML format</li><li>fixed error-path to match instance-identifier encoding for both XML and JSON</li><li>added references for YANG to JSON and YANG Metadata drafts</li><li>clarified that YANG JSON drafts are used for encoding, not plain JSON</li></ul></div></section><section id="v04-to-v05"><h3 id="rfc.section.B.9"><a href="#rfc.section.B.9">B.9</a>&nbsp;<a href="#v04-to-v05">v04 to v05</a></h3><div id="rfc.section.B.9.p.1"><ul><li>updated reference to RESTCONF</li></ul></div></section><section id="v03-to-v04"><h3 id="rfc.section.B.10"><a href="#rfc.section.B.10">B.10</a>&nbsp;<a href="#v03-to-v04">v03 to v04</a></h3><div id="rfc.section.B.10.p.1"><ul><li>removed NETCONF specific text</li><li>changed data-resource-offset typedef from a relative URI to an XPath absolute path expression</li><li>clarified insert operation</li><li>removed requirement that edits MUST be applied in ascending order</li><li>change SHOULD keep datastore unchanged on error to MUST (this is required by HTTP PATCH)</li><li>removed length restriction on 'comment' leaf</li><li>updated YANG tree for example-jukebox library</li></ul></div></section><section id="v02-to-v03"><h3 id="rfc.section.B.11"><a href="#rfc.section.B.11">B.11</a>&nbsp;<a href="#v02-to-v03">v02 to v03</a></h3><div id="rfc.section.B.11.p.1"><ul><li>added usage of restconf-media-type extension to map the yang-patch and yang-patch-status groupings to media types</li><li>added yang-patch RESTCONF capability URI</li><li>Added sub-section for terms used from RESTCONF</li><li>filled in security considerations section</li></ul></div></section><section id="v01-to-v02"><h3 id="rfc.section.B.12"><a href="#rfc.section.B.12">B.12</a>&nbsp;<a href="#v01-to-v02">v01 to v02</a></h3><div id="rfc.section.B.12.p.1"><ul><li>Reversed order of change log</li><li>Clarified anyxml structure of "value" parameter within a YANG patch request (github issue #1)</li><li>Updated RESTCONF reference</li><li>Added note to open issues section to check github instead</li></ul></div></section><section id="v00-to-v01"><h3 id="rfc.section.B.13"><a href="#rfc.section.B.13">B.13</a>&nbsp;<a href="#v00-to-v01">v00 to v01</a></h3><div id="rfc.section.B.13.p.1"><ul><li>Added text requiring support for Accept-Patch header field, and removed 'Identification of YANG Patch capabilities' open issue.</li><li>Removed 'location' leaf from yang-patch-status grouping</li><li>Removed open issue 'Protocol independence' because the location leaf was removed.</li><li>Removed
 open issue 'RESTCONF coupling' because there is no concern about a 
normative reference to RESTCONF. There may need to be a YANG 1.1 
mechanism to allow protocol template usage (instead of grouping 
wrapper).</li><li>Removed open issue 'Is the delete operation needed'. 
It was decided that both delete and remove should remain as operations 
and clients can choose which one to use. This is not an implementation 
burden on the server.</li><li>Removed open issue 'global-errors needed'.
 It was decided that they are needed as defined because the global 
&lt;ok/&gt; is needed and the special key value for edit=global error 
only allows for 1 global error.</li><li>Removed open issue 'Is location leaf needed'. It was decided that it is not needed so this leaf has been removed.</li><li>Removed
 open issue 'Bulk editing support in yang-patch-status'. The 'location' 
leaf has been removed so this issue is no longer applicable.</li><li>Removed
 open issue 'Edit list mechanism'. Added text to the 'edit' list 
description-stmt about how the individual edits must be processed. There
 is no concern about duplicate edits which cause intermediate results to
 be altered by subsequent edits in the same edit list.</li></ul></div></section><section id="biermanyang-patch-00-to-ietfyang-patch-00"><h3 id="rfc.section.B.14"><a href="#rfc.section.B.14">B.14</a>&nbsp;<a href="#biermanyang-patch-00-to-ietfyang-patch-00">bierman:yang-patch-00 to ietf:yang-patch-00</a></h3><div id="rfc.section.B.14.p.1"><ul><li>Created open issues section</li></ul></div></section></section><hr class="noprint"><section id="open-issues"><h2 id="rfc.section.C" class="np"><a href="#rfc.section.C">C.</a>&nbsp;<a href="#open-issues">Open Issues</a></h2><div id="rfc.figure.u.11"><pre>
    -- RFC Ed.: remove this section before publication.
	    </pre></div><div id="rfc.section.C.p.1" class="avoidbreakafter"><p>Refer to the github issue tracker for any open issues:</p></div><div id="rfc.section.C.p.2"><p><a href="https://github.com/netconf-wg/yang-patch/issues">https://github.com/netconf-wg/yang-patch/issues</a></p></div></section><hr class="noprint"><section id="example-yang-module"><h2 id="rfc.section.D" class="np"><a href="#rfc.section.D">D.</a>&nbsp;<a href="#example-yang-module">Example YANG Module</a></h2><div id="rfc.section.D.p.1"><p>The
 example YANG module used in this document represents a simple media 
jukebox interface. The "example‑jukebox" YANG module is defined in <a href="#I-D.ietf-netconf-restconf"><cite title="RESTCONF Protocol">[I-D.ietf-netconf-restconf]</cite></a>.</p></div><div id="rfc.section.D.p.2" class="avoidbreakafter"><p>YANG tree diagram for "example‑jukebox" Module:</p></div><div id="rfc.figure.u.12"><pre>
   +--rw jukebox!
      +--rw library
      |  +--rw artist* [name]
      |  |  +--rw name     string
      |  |  +--rw album* [name]
      |  |     +--rw name     string
      |  |     +--rw genre?   identityref
      |  |     +--rw year?    uint16
      |  |     +--rw admin
      |  |     |  +--rw label?              string
      |  |     |  +--rw catalogue-number?   string
      |  |     +--rw song* [name]
      |  |        +--rw name        string
      |  |        +--rw location    string
      |  |        +--rw format?     string
      |  |        +--rw length?     uint32
      |  +--ro artist-count?   uint32
      |  +--ro album-count?    uint32
      |  +--ro song-count?     uint32
      +--rw playlist* [name]
      |  +--rw name           string
      |  +--rw description?   string
      |  +--rw song* [index]
      |     +--rw index    uint32
      |     +--rw id       leafref
      +--rw player
         +--rw gap?   decimal64
	    </pre></div><div id="rfc.figure.u.13"><pre>
  rpcs:
	    </pre></div><div id="rfc.figure.u.14"><pre>
   +---x play
      +--ro input
         +--ro playlist       string
         +--ro song-number    uint32
	    </pre></div><section id="yang-patch-examples"><h3 id="rfc.section.D.1"><a href="#rfc.section.D.1">D.1</a>&nbsp;<a href="#yang-patch-examples">YANG Patch Examples</a></h3><div id="rfc.section.D.1.p.1"><p>This section includes RESTCONF examples. Most examples are shown in JSON encoding <a href="#RFC7159"><cite title="The JavaScript Object Notation (JSON) Data Interchange Format">[RFC7159]</cite></a>, and some are shown in XML encoding <a href="#W3C.REC-xml-20081126"><cite title="Extensible Markup Language (XML) 1.0 (Fifth Edition)">[W3C.REC-xml-20081126]</cite></a>.</p></div><section id="error-example"><h4 id="rfc.section.D.1.1"><a href="#rfc.section.D.1.1">D.1.1</a>&nbsp;<a href="#error-example">Add Resources: Error</a></h4><div id="rfc.section.D.1.1.p.1"><p>The
 following example shows several songs being added to an existing album.
 Each edit contains one song. The first song already exists, so an error
 will be reported for that edit. The rest of the edits were not 
attempted, since the first edit failed. The XML encoding is used in this
 example.</p></div><div id="rfc.section.D.1.1.p.2" class="avoidbreakafter"><p>Request from the RESTCONF client:</p></div><div id="rfc.figure.u.15"><pre>
   PATCH /restconf/data/example-jukebox:jukebox/\
      library/artist=Foo%20Fighters/album=Wasting%20Light HTTP/1.1
   Host: example.com
   Accept: application/yang-data+xml
   Content-Type: application/yang-patch+xml

   &lt;yang-patch xmlns="urn:ietf:params:xml:ns:yang:ietf-yang-patch"&gt;
     &lt;patch-id&gt;add-songs-patch&lt;/patch-id&gt;
     &lt;edit&gt;
       &lt;edit-id&gt;edit1&lt;/edit-id&gt;
       &lt;operation&gt;create&lt;/operation&gt;
       &lt;target&gt;/song=Bridge%20Burning&lt;/target&gt;
       &lt;value&gt;
         &lt;song xmlns="http://example.com/ns/example-jukebox"&gt;
           &lt;name&gt;Bridge Burning&lt;/name&gt;
           &lt;location&gt;/media/bridge_burning.mp3&lt;/location&gt;
           &lt;format&gt;MP3&lt;/format&gt;
           &lt;length&gt;288&lt;/length&gt;
         &lt;/song&gt;
       &lt;/value&gt;
     &lt;/edit&gt;
     &lt;edit&gt;
       &lt;edit-id&gt;edit2&lt;/edit-id&gt;
       &lt;operation&gt;create&lt;/operation&gt;
       &lt;target&gt;/song=Rope&lt;/target&gt;
       &lt;value&gt;
         &lt;song xmlns="http://example.com/ns/example-jukebox"&gt;
           &lt;name&gt;Rope&lt;/name&gt;
           &lt;location&gt;/media/rope.mp3&lt;/location&gt;
           &lt;format&gt;MP3&lt;/format&gt;
           &lt;length&gt;259&lt;/length&gt;
         &lt;/song&gt;
       &lt;/value&gt;
     &lt;/edit&gt;
     &lt;edit&gt;
       &lt;edit-id&gt;edit3&lt;/edit-id&gt;
       &lt;operation&gt;create&lt;/operation&gt;
       &lt;target&gt;/song=Dear%20Rosemary&lt;/target&gt;
       &lt;value&gt;
         &lt;song xmlns="http://example.com/ns/example-jukebox"&gt;
           &lt;name&gt;Dear Rosemary&lt;/name&gt;
           &lt;location&gt;/media/dear_rosemary.mp3&lt;/location&gt;
           &lt;format&gt;MP3&lt;/format&gt;
           &lt;length&gt;269&lt;/length&gt;
         &lt;/song&gt;
       &lt;/value&gt;
     &lt;/edit&gt;
   &lt;/yang-patch&gt;
	    </pre></div><div id="rfc.section.D.1.1.p.3" class="avoidbreakafter"><p>XML Response from the RESTCONF server:</p></div><div id="rfc.figure.u.16"><pre>
   HTTP/1.1 409 Conflict
   Date: Mon, 23 Apr 2012 13:01:20 GMT
   Server: example-server
   Last-Modified: Mon, 23 Apr 2012 13:01:20 GMT
   Content-Type: application/yang-data+xml

   &lt;yang-patch-status
      xmlns="urn:ietf:params:xml:ns:yang:ietf-yang-patch"&gt;
     &lt;patch-id&gt;add-songs-patch&lt;/patch-id&gt;
     &lt;edit-status&gt;
       &lt;edit&gt;
          &lt;edit-id&gt;edit1&lt;/edit-id&gt;
          &lt;errors&gt;
             &lt;error&gt;
                &lt;error-type&gt;application&lt;/error-type&gt;
                &lt;error-tag&gt;data-exists&lt;/error-tag&gt;
                &lt;error-path
                  xmlns:jb="http://example.com/ns/example-jukebox"&gt;
                  /jb:jukebox/jb:library
                  /jb:artist[jb:name='Foo Fighters']
                  /jb:album[jb:name='Wasting Light']
                  /jb:song[jb:name='Burning Light']
                &lt;/error-path&gt;
                &lt;error-message&gt;
                  Data already exists, cannot be created
                &lt;/error-message&gt;
             &lt;/error&gt;
          &lt;/errors&gt;
       &lt;/edit&gt;
    &lt;/edit-status&gt;
  &lt;/yang-patch-status&gt;
	    </pre></div><div id="rfc.section.D.1.1.p.4" class="avoidbreakafter"><p>JSON Response from the RESTCONF server:</p></div><div id="rfc.section.D.1.1.p.5"><p>The
 following response is shown in JSON format to highlight the difference 
in the "error‑path" object encoding. For JSON, the instance-identifier 
encoding in the "JSON Encoding of YANG Data" draft is used.</p></div><div id="rfc.figure.u.17"><pre>
   HTTP/1.1 409 Conflict
   Date: Mon, 23 Apr 2012 13:01:20 GMT
   Server: example-server
   Last-Modified: Mon, 23 Apr 2012 13:01:20 GMT
   Content-Type: application/yang-data+json

   {
     "ietf-yang-patch:yang-patch-status" : {
       "patch-id" : "add-songs-patch",
       "edit-status" : {
         "edit" : [
           {
             "edit-id" : "edit1",
             "errors" : {
               "error" : [
                 {
                   "error-type": "application",
                   "error-tag": "data-exists",
                   "error-path": "/example-jukebox:jukebox/library\
                      /artist[name='Foo Fighters']\
                      /album[name='Wasting Light']\
                      /song[name='Burning Light']",
                   "error-message":
                     "Data already exists, cannot be created"
                 }
               ]
             }
           }
         ]
       }
     }
   }
	    </pre></div></section><section id="success-example"><h4 id="rfc.section.D.1.2"><a href="#rfc.section.D.1.2">D.1.2</a>&nbsp;<a href="#success-example">Add Resources: Success</a></h4><div id="rfc.section.D.1.2.p.1"><p>The following example shows several songs being added to an existing album.</p></div><div id="rfc.section.D.1.2.p.2"><ul><li>Each of 2 edits contains one song.</li><li>Both edits succeed and new sub-resources are created</li></ul></div><div id="rfc.section.D.1.2.p.3" class="avoidbreakafter"><p>Request from the RESTCONF client:</p></div><div id="rfc.figure.u.18"><pre>
   PATCH /restconf/data/example-jukebox:jukebox/\
      library/artist=Foo%20Fighters/album=Wasting%20Light \
      HTTP/1.1
   Host: example.com
   Accept: application/yang-data+json
   Content-Type: application/yang-patch+json

   {
     "ietf-yang-patch:yang-patch" : {
       "patch-id" : "add-songs-patch-2",
       "edit" : [
         {
           "edit-id" : "edit1",
           "operation" : "create",
           "target" : "/song=Rope",
           "value" : {
             "song" : {
               "name" : "Rope",
               "location" : "/media/rope.mp3",
               "format" : "MP3",
               "length" : 259
             }
           }
         },
         {
           "edit-id" : "edit2",
           "operation" : "create",
           "target" : "/song=Dear%20Rosemary",
           "value" : {
             "song" : {
               "name" : "Dear Rosemary",
               "location" : "/media/dear_rosemary.mp3",
               "format" : "MP3",
               "length" : 269
             }
           }
         }
       ]
     }
   }
	    </pre></div><div id="rfc.section.D.1.2.p.4" class="avoidbreakafter"><p>Response from the RESTCONF server:</p></div><div id="rfc.figure.u.19"><pre>
   HTTP/1.1 200 OK
   Date: Mon, 23 Apr 2012 13:01:20 GMT
   Server: example-server
   Last-Modified: Mon, 23 Apr 2012 13:01:20 GMT
   Content-Type: application/yang-data+json

   {
     "ietf-yang-patch:yang-patch-status" : {
       "patch-id" : "add-songs-patch-2",
       "ok" : [null]
     }
   }
	    </pre></div></section><section id="insert-list-entry-example"><h4 id="rfc.section.D.1.3"><a href="#rfc.section.D.1.3">D.1.3</a>&nbsp;<a href="#insert-list-entry-example">Insert list entry example</a></h4><div id="rfc.section.D.1.3.p.1"><p>The
 following example shows a song being inserted within an existing 
playlist. Song "6" in playlist "Foo‑One" is being inserted after song 
"5" in the playlist. The operation succeeds, so a non-error reply 
example can be shown.</p></div><div id="rfc.figure.u.20"><pre>
 Request from the RESTCONF client:

   PATCH /restconf/data/example-jukebox:jukebox/\
     playlist=Foo-One HTTP/1.1
   Host: example.com
   Accept: application/yang-data+json
   Content-Type: application/yang-patch+json

   {
     "ietf-yang-patch:yang-patch" : {
       "patch-id" : "move-song-patch",
       "comment" : "Insert song 6 after song 5",
       "edit" : [
         {
           "edit-id" : "edit1",
           "operation" : "insert",
           "target" : "/song=6",
           "point" : "/song=5",
           "where" : "after",
           "value" : {
             "example-jukebox:song" : {
               "name" : "Dear Prudence",
               "location" : "/media/dear_prudence.mp3",
               "format" : "MP3",
               "length" : 236
             }
           }
         }
       ]
     }
   }

 Response from the RESTCONF server:

   HTTP/1.1 200 OK
   Date: Mon, 23 Apr 2012 13:01:20 GMT
   Server: example-server
   Last-Modified: Mon, 23 Apr 2012 13:01:20 GMT
   Content-Type: application/yang-data+json

   {
     "ietf-yang-patch:yang-patch-status" : {
       "patch-id" : "move-song-patch",
       "ok" : [null]
     }
   }
	    </pre></div></section><section id="move-list-entry-example"><h4 id="rfc.section.D.1.4"><a href="#rfc.section.D.1.4">D.1.4</a>&nbsp;<a href="#move-list-entry-example">Move list entry example</a></h4><div id="rfc.section.D.1.4.p.1"><p>The
 following example shows a song being moved within an existing playlist.
 Song "1" in playlist "Foo‑One" is being moved after song "3" in the 
playlist. Note that no "value" parameter is needed for a "move" 
operation. The operation succeeds, so a non-error reply example can be 
shown.</p></div><div id="rfc.section.D.1.4.p.2" class="avoidbreakafter"><p>Request from the RESTCONF client:</p></div><div id="rfc.figure.u.21"><pre>
   PATCH /restconf/data/example-jukebox:jukebox/\
     playlist=Foo-One HTTP/1.1
   Host: example.com
   Accept: application/yang-data+json
   Content-Type: application/yang-patch+json

   {
     "ietf-yang-patch:yang-patch" : {
       "patch-id" : "move-song-patch",
       "comment" : "Move song 1 after song 3",
       "edit" : [
         {
           "edit-id" : "edit1",
           "operation" : "move",
           "target" : "/song=1",
           "point" : "/song=3",
           "where" : "after"
         }
       ]
     }
   }
	    </pre></div><div id="rfc.section.D.1.4.p.3" class="avoidbreakafter"><p>Response from the RESTCONF server:</p></div><div id="rfc.figure.u.22"><pre>
   HTTP/1.1 200 OK
   Date: Mon, 23 Apr 2012 13:01:20 GMT
   Server: example-server
   Last-Modified: Mon, 23 Apr 2012 13:01:20 GMT
   Content-Type: application/yang-data+json

   {
     "ietf-restconf:yang-patch-status" : {
       "patch-id" : "move-song-patch",
       "ok" : [null]
     }
   }
	    </pre></div></section><section id="edit-datastore-resource-example"><h4 id="rfc.section.D.1.5"><a href="#rfc.section.D.1.5">D.1.5</a>&nbsp;<a href="#edit-datastore-resource-example">Edit datastore resource example</a></h4><div id="rfc.section.D.1.5.p.1"><p>The following example shows how 3 top-level data nodes from different modules can be edited at the same time.</p></div><div id="rfc.section.D.1.5.p.2"><p>Example
 module "foo" defines leaf X. Example module "bar" defines container Y, 
with child leafs A and B. Example module "baz" defines list Z, with key C
 and child leafs D and E.</p></div><div id="rfc.section.D.1.5.p.3" class="avoidbreakafter"><p>Request from the RESTCONF client:</p></div><div id="rfc.figure.u.23"><pre>
   PATCH /restconf/data HTTP/1.1
   Host: example.com
   Accept: application/yang-data+json
   Content-Type: application/yang-patch+json

   {
     "ietf-yang-patch:yang-patch" : {
       "patch-id" : "datastore-patch-1",
       "comment" : "Edit 3 top-level data nodes at once",
       "edit" : [
         {
           "edit-id" : "edit1",
           "operation" : "create",
           "target" : "/foo:X",
           "value" : {
             "foo:X" : 42
           }
         },
         {
           "edit-id" : "edit2",
           "operation" : "merge",
           "target" : "/bar:Y",
           "value" : {
             "bar:Y" : {
               "A" : "test1",
               "B" : 99
             }
           }
         },
         {
           "edit-id" : "edit3",
           "operation" : "replace",
           "target" : "/baz:Z=2",
           "value" : {
             "baz:Z" : {
               "C" : 2,
               "D" : 100,
               "E" : false
             }
           }
         }
       ]
     }
   }
	    </pre></div><div id="rfc.section.D.1.5.p.4" class="avoidbreakafter"><p>Response from the RESTCONF server:</p></div><div id="rfc.figure.u.24"><pre>
   HTTP/1.1 200 OK
   Date: Mon, 23 Apr 2012 13:02:20 GMT
   Server: example-server
   Last-Modified: Mon, 23 Apr 2012 13:01:20 GMT
   Content-Type: application/yang-data+json

   {
     "ietf-yang-patch:yang-patch-status" : {
       "patch-id" : "datastore-patch-1",
       "ok" : [null]
     }
   }
	    </pre></div></section></section></section><hr class="noprint"><section id="rfc.authors" class="np"><h2><a href="#rfc.authors">Authors' Addresses</a></h2><address><b>Andy Bierman</b><br>YumaWorks<br>EMail: <a href="mailto:andy@yumaworks.com">andy@yumaworks.com</a></address><address><b>Martin Bjorklund</b><br>Tail-f Systems<br>EMail: <a href="mailto:mbj@tail-f.com">mbj@tail-f.com</a></address><address><b>Kent Watsen</b><br>Juniper Networks<br>EMail: <a href="mailto:kwatsen@juniper.net">kwatsen@juniper.net</a></address></section></body></html>